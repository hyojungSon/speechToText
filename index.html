<!DOCTYPE html>
<html lang="kr">
	<head>
	<meta charset="utf-8" />

	<title>STT</title>
	<style>
		button{
			width: 200px;
			background-color: gray;
			color: white;
			border: 1px solid gray;
			border-radius: 2px;
			padding: 0 15px;
			margin: 25px;
			cursor: pointer;
			box-shadow: 0 1px 2px 0 rgba(0,0,0,.2);
			transition: all 0.3s ease-in-out;
		}
		.activeBtn {
			background-color: green;
			color: white;
			border: 1px solid green;
			transform: scale(1.1);
		}
	</style>
	</head>

	<body>
		<h1>GSC STT(Speech To Text)</h1>
		<button id="startButton"><p class="lblBtn">Ready to record</p> </button>
		
		<div> <p class="output"><em></em></p> </div>

		<script>
			let isRecording = false;
			const startButton = document.getElementById('startButton');
			const [lblBtn] = document.getElementsByClassName('lblBtn');

			var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition
			var SpeechRecognitionEvent = SpeechRecognitionEvent || webkitSpeechRecognitionEvent

			var recognition = new SpeechRecognition();

			/** continuous: Controls whether continuous results are returned for each recognition, or only a single result. Defaults to single **/
			recognition.continuous = false;
			recognition.lang = 'ko-KR';
			/** interimResults: Controls whether interim results should be returned (true) or not (false.) Interim results are results that are not yet final **/
			recognition.interimResults = false;
			recognition.maxAlternatives = 1;

			let diagnostic = null;
			let makeNewTextContent = function() {
				if(diagnostic === null){
					diagnostic = document.createElement('p');
					document.querySelector('.output').appendChild(diagnostic);
				}
			};

			startButton.addEventListener('click', () => {
				if(isRecording === false){
					lblBtn.textContent = "Recording ...";
					startButton.className = "activeBtn";
					makeNewTextContent();

					recognition.start();
				}else{
					lblBtn.textContent = "Ready to record";
					startButton.className = "";

					recognition.stop();
				}
				isRecording = !isRecording;
			});

			recognition.onresult = function(event) {
				diagnostic.textContent = 'Result received: ' + event.results[0][0].transcript + '.';
			}

			recognition.onerror = function(event) {
				diagnostic.textContent = 'Error occurred in recognition: ' + event.error;
			}
		</script>
	</body>
</html>
